<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Add Item to Fridge</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <h2>Add Item to Fridge</h2>

  <button id="scan-btn" class="btn">Scan Barcode</button>

  <div class="form-container">
    <label>Item Name:
      <input type="text" id="itemName" required>
    </label>

    <label>Quantity:
      <input type="number" id="quantity" value="1" min="1">
    </label>

    <label>Unit: (optional)
      <input type="text" id="unit">
    </label>

    <label>Purchase Date:
      <input type="date" id="purchaseDate">
    </label>

    <label>Expiry Date: (optional)
      <input type="date" id="expiryDate">
    </label>

    <label>Location:
      <select id="location">
        <option value="">Select location</option>
        <option value="Freezer (garage)">Freezer (garage)</option>
        <option value="Freezer (dining room)">Freezer (dining room)</option>
        <option value="Fridge (dining room)">Fridge (dining room)</option>
        <option value="Fridge (kitchen)">Fridge (kitchen)</option>
      </select>
    </label>

    <label>Scanned Barcode:
      <input type="text" id="barcode" readonly placeholder="(none)">
    </label>

    <button id="submitBtn" class="btn">Add Item</button>
    <p id="statusMsg"></p>
    <button onclick="goHome()" class="btn btn-grey">Home</button>
  </div>

  <script>
    const webAppUrl = 'https://script.google.com/macros/s/AKfycbyThkEhW3QIAIZcXhgvc5bfDgwZ8TG7wZqley13fHAqreh9FnohK37jcfPx8HlHgRXD/exec';

    document.getElementById('submitBtn').addEventListener('click', () => {
      const item = document.getElementById('itemName').value.trim();
      const quantity = document.getElementById('quantity').value;
      const unit = document.getElementById('unit').value;
      const purchaseDate = document.getElementById('purchaseDate').value;
      const expiryDate = document.getElementById('expiryDate').value;
      const location = document.getElementById('location').value;
      const barcode = document.getElementById('barcode').value;

      const params = new URLSearchParams({
        item,
        quantity,
        unit,
        purchaseDate,
        expiryDate,
        location,
        barcode
      });

      fetch(`${webAppUrl}?${params.toString()}`)
        .then(response => response.text())
        .then(result => {
          const statusMsg = document.getElementById('statusMsg');
          statusMsg.textContent = result;
          statusMsg.style.color = result.includes('successfully') ? 'green' : 'red';

          setTimeout(() => {
            statusMsg.textContent = '';
          }, 5000);
        });
    });

    document.getElementById('scan-btn').addEventListener('click', () => {
      window.location.href = 'scanner.html';
    });

    function goHome() {
      window.location.href = 'index.html';
    }

    document.getElementById('purchaseDate').valueAsDate = new Date();
  </script>
</body>
</html>
