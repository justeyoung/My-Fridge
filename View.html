<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Inventory Viewer</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <h2>Inventory</h2>
  <div id="inventory-container"></div>
  <button class="home-btn" onclick="window.location.href='index.html'">Home</button>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyThkEhW3QIAIZcXhgvc5bfDgwZ8TG7wZqley13fHAqreh9FnohK37jcfPx8HlHgRXD/exec';

    fetch(scriptURL)
      .then(response => response.json())
      .then(data => {
        const container = document.getElementById('inventory-container');
        const grouped = {};

        data.forEach(item => {
          const location = item['Location'] || 'Unknown';
          if (!grouped[location]) grouped[location] = [];
          grouped[location].push(item);
        });

        const sortedLocations = Object.keys(grouped).sort();

        sortedLocations.forEach(location => {
          const section = document.createElement('div');
          section.className = 'location-group';

          const heading = document.createElement('h3');
          heading.textContent = `Location: ${location}`;
          section.appendChild(heading);

          const table = document.createElement('table');
          const thead = document.createElement('thead');
          thead.innerHTML = '<tr><th>#</th><th>Item</th><th>Quantity</th><th>Unit</th></tr>';
          table.appendChild(thead);

          const tbody = document.createElement('tbody');
          grouped[location].forEach((item, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${index + 1}</td>
              <td>${item['Item']}</td>
              <td>${item['Quantity']}</td>
              <td>${item['Unit']}</td>
            `;
            tbody.appendChild(row);
          });

          table.appendChild(tbody);
          section.appendChild(table);
          container.appendChild(section);
        });
      })
      .catch(() => {
        document.getElementById('inventory-container').innerHTML =
          '<p style="color:red">Error fetching inventory data.</p>';
      });
  </script>
</body>
</html>
