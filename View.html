<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Current Inventory</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <h2>Current Inventory</h2>
  <div id="inventoryTable">Loading...</div>
  <button class="home-button" onclick="location.href='index.html'">Home</button>

  <script>
    const sheetURL = 'https://script.google.com/macros/s/AKfycbyThkEhW3QIAIZcXhgvc5bfDgwZ8TG7wZqley13fHAqreh9FnohK37jcfPx8HlHgRXD/exec';

    fetch(sheetURL)
      .then(res => res.json())
      .then(data => {
        if (!Array.isArray(data) || data.length === 0) {
          document.getElementById("inventoryTable").textContent = "No inventory data found.";
          return;
        }

        // Group items by Location
        const grouped = {};
        data.forEach(item => {
          const loc = item["Location"] || "Unknown";
          if (!grouped[loc]) grouped[loc] = [];
          grouped[loc].push(item);
        });

        const container = document.getElementById("inventoryTable");
        container.innerHTML = "";

        // Render each location group
        Object.keys(grouped).sort().forEach(location => {
          const section = document.createElement("div");
          const title = document.createElement("h3");
          title.textContent = `Location: ${location}`;
          section.appendChild(title);

          const table = document.createElement("table");
          const thead = table.insertRow();
          ["#", "Item", "Quantity", "Unit"].forEach(h => {
            const th = document.createElement("th");
            th.textContent = h;
            thead.appendChild(th);
          });

          grouped[location].forEach((entry, index) => {
            const row = table.insertRow();
            row.insertCell().textContent = index + 1;
            row.insertCell().textContent = entry["Item"] || "";
            row.insertCell().textContent = entry["Quantity"] || "";
            row.insertCell().textContent = entry["Unit"] || "";
          });

          section.appendChild(table);
          container.appendChild(section);
        });
      })
      .catch(error => {
        console.error("Error loading data:", error);
        document.getElementById("inventoryTable").textContent = "Error fetching inventory data.";
      });
  </script>
</body>
</html>
